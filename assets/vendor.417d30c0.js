var lt=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Ae(et){return et&&et.__esModule&&Object.prototype.hasOwnProperty.call(et,"default")?et.default:et}var le={exports:{}};(function(et,Fe){(function(D,O){et.exports=O()})(lt,function(){return function(D){var O={};function f(s){if(O[s])return O[s].exports;var u=O[s]={i:s,l:!1,exports:{}};return D[s].call(u.exports,u,u.exports,f),u.l=!0,u.exports}return f.m=D,f.c=O,f.d=function(s,u,p){f.o(s,u)||Object.defineProperty(s,u,{enumerable:!0,get:p})},f.r=function(s){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},f.t=function(s,u){if(1&u&&(s=f(s)),8&u||4&u&&typeof s=="object"&&s&&s.__esModule)return s;var p=Object.create(null);if(f.r(p),Object.defineProperty(p,"default",{enumerable:!0,value:s}),2&u&&typeof s!="string")for(var I in s)f.d(p,I,function(c){return s[c]}.bind(null,I));return p},f.n=function(s){var u=s&&s.__esModule?function(){return s.default}:function(){return s};return f.d(u,"a",u),u},f.o=function(s,u){return Object.prototype.hasOwnProperty.call(s,u)},f.p="",f(f.s=1)}([function(D,O,f){Object.defineProperty(O,"__esModule",{value:!0});var s,u=function(v,l){if(Array.isArray(v))return v;if(Symbol.iterator in Object(v))return function(y,m){var x=[],A=!0,g=!1,i=void 0;try{for(var e,o=y[Symbol.iterator]();!(A=(e=o.next()).done)&&(x.push(e.value),!m||x.length!==m);A=!0);}catch(b){g=!0,i=b}finally{try{!A&&o.return&&o.return()}finally{if(g)throw i}}return x}(v,l);throw new TypeError("Invalid attempt to destructure non-iterable instance")},p=f(3),I=(s=p)&&s.__esModule?s:{default:s},c={getItem:function(v,l){return c.multiGet([v]).then(function(y){return y[0][1]}).then(function(y){return l&&l(null,y),y}).catch(function(y){return l&&l(y,null),y})},setItem:function(v,l,y){return c.multiSet([[v,l]]).then(function(m){return y&&y(null,m),m}).catch(function(m){return y&&y(m,null),m})},getAllKeys:function(v){return Promise.resolve(Object.keys(localStorage)).then(function(l){return v&&v(null,l),l}).catch(function(l){return v&&v(l,null),l})},removeItem:function(v,l){return c.multiRemove([v]).then(function(){l&&l(null)}).catch(function(y){l&&l(y,null)})},clear:function(){return new Promise(function(v){window.localStorage.clear(),v()})},mergeItem:function(v,l){return c.multiMerge([[v,l]])},multiGet:function(v){return new Promise(function(l){l(v.reduce(function(y,m){return y.concat([[m,localStorage.getItem(m)]])},[]))})},multiSet:function(v){return new Promise(function(l,y){var m=[];return v.forEach(function(x){var A=u(x,2),g=A[0],i=A[1];try{localStorage.setItem(g,i)}catch(e){m.push(e)}}),m.length>0?y(m):l()})},multiMerge:function(v){return new Promise(function(l,y){var m=[];return v.forEach(function(x){var A=u(x,2),g=A[0],i=A[1],e=localStorage.getItem(g);if(e)try{localStorage.setItem(g,JSON.stringify((0,I.default)(JSON.parse(e),JSON.parse(i))))}catch(o){m.push(o)}}),m.length>0?y(m):l()})},multiRemove:function(v){return new Promise(function(l){v.forEach(function(y){return window.localStorage.removeItem(y)}),l()})},flushGetRequests:function(){console.warn("AsyncStorage.flushGetRequests: Not supported on `web`")}};O.default=c},function(D,O,f){f.r(O),f.d(O,"createFlagsmithInstance",function(){return v});var s=f(0),u=f.n(s),p=f(2).default,I=f(5),c=I({AsyncStorage:u.a,fetch:p});typeof window!="undefined"&&(window.flagsmith=c),O.default=c;var v=function(){return I({AsyncStorage:u.a,fetch:p})}},function(D,O,f){f.r(O),O.default=function(s,u){return u=u||{},new Promise(function(p,I){var c=new XMLHttpRequest,v=[],l=[],y={},m=function(){return{ok:(c.status/100|0)==2,statusText:c.statusText,status:c.status,url:c.responseURL,text:function(){return Promise.resolve(c.responseText)},json:function(){return Promise.resolve(JSON.parse(c.responseText))},blob:function(){return Promise.resolve(new Blob([c.response]))},clone:m,headers:{keys:function(){return v},entries:function(){return l},get:function(A){return y[A.toLowerCase()]},has:function(A){return A.toLowerCase()in y}}}};for(var x in c.open(u.method||"get",s,!0),c.onload=function(){c.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(A,g,i){v.push(g=g.toLowerCase()),l.push([g,i]),y[g]=y[g]?y[g]+","+i:i}),p(m())},c.onerror=I,c.withCredentials=u.credentials=="include",u.headers)c.setRequestHeader(x,u.headers[x]);c.send(u.body||null)})}},function(D,O,f){(function(s){var u=200,p="__lodash_hash_undefined__",I=800,c=16,v=9007199254740991,l="[object Arguments]",y="[object AsyncFunction]",m="[object Function]",x="[object GeneratorFunction]",A="[object Null]",g="[object Object]",i="[object Proxy]",e="[object Undefined]",o=/^\[object .+?Constructor\]$/,b=/^(?:0|[1-9]\d*)$/,h={};h["[object Float32Array]"]=h["[object Float64Array]"]=h["[object Int8Array]"]=h["[object Int16Array]"]=h["[object Int32Array]"]=h["[object Uint8Array]"]=h["[object Uint8ClampedArray]"]=h["[object Uint16Array]"]=h["[object Uint32Array]"]=!0,h[l]=h["[object Array]"]=h["[object ArrayBuffer]"]=h["[object Boolean]"]=h["[object DataView]"]=h["[object Date]"]=h["[object Error]"]=h[m]=h["[object Map]"]=h["[object Number]"]=h[g]=h["[object RegExp]"]=h["[object Set]"]=h["[object String]"]=h["[object WeakMap]"]=!1;var F=typeof lt=="object"&&lt&&lt.Object===Object&&lt,k=typeof self=="object"&&self&&self.Object===Object&&self,P=F||k||Function("return this")(),L=O&&!O.nodeType&&O,C=L&&typeof s=="object"&&s&&!s.nodeType&&s,_=C&&C.exports===L,$=_&&F.process,tt=function(){try{var t=C&&C.require&&C.require("util").types;return t||$&&$.binding&&$.binding("util")}catch{}}(),W=tt&&tt.isTypedArray;function X(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}var N,H,Q,q=Array.prototype,w=Function.prototype,ot=Object.prototype,It=P["__core-js_shared__"],dt=w.toString,Y=ot.hasOwnProperty,Mt=(N=/[^.]+$/.exec(It&&It.keys&&It.keys.IE_PROTO||""))?"Symbol(src)_1."+N:"",Ut=ot.toString,fe=dt.call(Object),ge=RegExp("^"+dt.call(Y).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),bt=_?P.Buffer:void 0,Bt=P.Symbol,Gt=P.Uint8Array,$t=bt?bt.allocUnsafe:void 0,qt=(H=Object.getPrototypeOf,Q=Object,function(t){return H(Q(t))}),Vt=Object.create,he=ot.propertyIsEnumerable,ve=q.splice,nt=Bt?Bt.toStringTag:void 0,mt=function(){try{var t=Ft(Object,"defineProperty");return t({},"",{}),t}catch{}}(),pe=bt?bt.isBuffer:void 0,Ht=Math.max,ye=Date.now,Kt=Ft(P,"Map"),ft=Ft(Object,"create"),de=function(){function t(){}return function(n){if(!it(n))return{};if(Vt)return Vt(n);t.prototype=n;var r=new t;return t.prototype=void 0,r}}();function rt(t){var n=-1,r=t==null?0:t.length;for(this.clear();++n<r;){var a=t[n];this.set(a[0],a[1])}}function Z(t){var n=-1,r=t==null?0:t.length;for(this.clear();++n<r;){var a=t[n];this.set(a[0],a[1])}}function at(t){var n=-1,r=t==null?0:t.length;for(this.clear();++n<r;){var a=t[n];this.set(a[0],a[1])}}function ut(t){var n=this.__data__=new Z(t);this.size=n.size}function be(t,n){var r=Nt(t),a=!r&&kt(t),d=!r&&!a&&Zt(t),E=!r&&!a&&!d&&ee(t),j=r||a||d||E,J=j?function(V,Jt){for(var ht=-1,st=Array(V);++ht<V;)st[ht]=Jt(ht);return st}(t.length,String):[],z=J.length;for(var S in t)!n&&!Y.call(t,S)||j&&(S=="length"||d&&(S=="offset"||S=="parent")||E&&(S=="buffer"||S=="byteLength"||S=="byteOffset")||Qt(S,z))||J.push(S);return J}function Pt(t,n,r){(r===void 0||St(t[n],r))&&(r!==void 0||n in t)||At(t,n,r)}function me(t,n,r){var a=t[n];Y.call(t,n)&&St(a,r)&&(r!==void 0||n in t)||At(t,n,r)}function _t(t,n){for(var r=t.length;r--;)if(St(t[r][0],n))return r;return-1}function At(t,n,r){n=="__proto__"&&mt?mt(t,n,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[n]=r}rt.prototype.clear=function(){this.__data__=ft?ft(null):{},this.size=0},rt.prototype.delete=function(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n},rt.prototype.get=function(t){var n=this.__data__;if(ft){var r=n[t];return r===p?void 0:r}return Y.call(n,t)?n[t]:void 0},rt.prototype.has=function(t){var n=this.__data__;return ft?n[t]!==void 0:Y.call(n,t)},rt.prototype.set=function(t,n){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ft&&n===void 0?p:n,this},Z.prototype.clear=function(){this.__data__=[],this.size=0},Z.prototype.delete=function(t){var n=this.__data__,r=_t(n,t);return!(r<0)&&(r==n.length-1?n.pop():ve.call(n,r,1),--this.size,!0)},Z.prototype.get=function(t){var n=this.__data__,r=_t(n,t);return r<0?void 0:n[r][1]},Z.prototype.has=function(t){return _t(this.__data__,t)>-1},Z.prototype.set=function(t,n){var r=this.__data__,a=_t(r,t);return a<0?(++this.size,r.push([t,n])):r[a][1]=n,this},at.prototype.clear=function(){this.size=0,this.__data__={hash:new rt,map:new(Kt||Z),string:new rt}},at.prototype.delete=function(t){var n=jt(this,t).delete(t);return this.size-=n?1:0,n},at.prototype.get=function(t){return jt(this,t).get(t)},at.prototype.has=function(t){return jt(this,t).has(t)},at.prototype.set=function(t,n){var r=jt(this,t),a=r.size;return r.set(t,n),this.size+=r.size==a?0:1,this},ut.prototype.clear=function(){this.__data__=new Z,this.size=0},ut.prototype.delete=function(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r},ut.prototype.get=function(t){return this.__data__.get(t)},ut.prototype.has=function(t){return this.__data__.has(t)},ut.prototype.set=function(t,n){var r=this.__data__;if(r instanceof Z){var a=r.__data__;if(!Kt||a.length<u-1)return a.push([t,n]),this.size=++r.size,this;r=this.__data__=new at(a)}return r.set(t,n),this.size=r.size,this};var _e=function(t,n,r){for(var a=-1,d=Object(t),E=r(t),j=E.length;j--;){var J=E[++a];if(n(d[J],J,d)===!1)break}return t};function Ot(t){return t==null?t===void 0?e:A:nt&&nt in Object(t)?function(n){var r=Y.call(n,nt),a=n[nt];try{n[nt]=void 0;var d=!0}catch{}var E=Ut.call(n);return d&&(r?n[nt]=a:delete n[nt]),E}(t):function(n){return Ut.call(n)}(t)}function Wt(t){return gt(t)&&Ot(t)==l}function Oe(t){return!(!it(t)||function(n){return!!Mt&&Mt in n}(t))&&(Lt(t)?ge:o).test(function(n){if(n!=null){try{return dt.call(n)}catch{}try{return n+""}catch{}}return""}(t))}function je(t){if(!it(t))return function(d){var E=[];if(d!=null)for(var j in Object(d))E.push(j);return E}(t);var n=Yt(t),r=[];for(var a in t)(a!="constructor"||!n&&Y.call(t,a))&&r.push(a);return r}function Xt(t,n,r,a,d){t!==n&&_e(n,function(E,j){if(d||(d=new ut),it(E))(function(z,S,V,Jt,ht,st,vt){var K=Tt(z,V),R=Tt(S,V),ie=vt.get(R);if(ie)return void Pt(z,V,ie);var G=st?st(K,R,V+"",z,S,vt):void 0,pt=G===void 0;if(pt){var Dt=Nt(R),zt=!Dt&&Zt(R),oe=!Dt&&!zt&&ee(R);G=R,Dt||zt||oe?Nt(K)?G=K:gt(ue=K)&&xt(ue)?G=function(T,M){var U=-1,B=T.length;for(M||(M=Array(B));++U<B;)M[U]=T[U];return M}(K):zt?(pt=!1,G=function(T,M){if(M)return T.slice();var U=T.length,B=$t?$t(U):new T.constructor(U);return T.copy(B),B}(R,!0)):oe?(pt=!1,yt=R,ae=(wt=yt.buffer,Rt=new wt.constructor(wt.byteLength),new Gt(Rt).set(new Gt(wt)),Rt),G=new yt.constructor(ae,yt.byteOffset,yt.length)):G=[]:function(T){if(!gt(T)||Ot(T)!=g)return!1;var M=qt(T);if(M===null)return!0;var U=Y.call(M,"constructor")&&M.constructor;return typeof U=="function"&&U instanceof U&&dt.call(U)==fe}(R)||kt(R)?(G=K,kt(K)?G=function(T){return function(M,U,B,se){var Ie=!B;B||(B={});for(var ce=-1,Pe=U.length;++ce<Pe;){var ct=U[ce],Et=se?se(B[ct],M[ct],ct,B,M):void 0;Et===void 0&&(Et=M[ct]),Ie?At(B,ct,Et):me(B,ct,Et)}return B}(T,ne(T))}(K):it(K)&&!Lt(K)||(G=function(T){return typeof T.constructor!="function"||Yt(T)?{}:de(qt(T))}(R))):pt=!1}var yt,ae,wt,Rt,ue;pt&&(vt.set(R,G),ht(G,R,Jt,st,vt),vt.delete(R)),Pt(z,V,G)})(t,n,j,r,Xt,a,d);else{var J=a?a(Tt(t,j),E,j+"",t,n,d):void 0;J===void 0&&(J=E),Pt(t,j,J)}},ne)}function Se(t,n){return we(function(r,a,d){return a=Ht(a===void 0?r.length-1:a,0),function(){for(var E=arguments,j=-1,J=Ht(E.length-a,0),z=Array(J);++j<J;)z[j]=E[a+j];j=-1;for(var S=Array(a+1);++j<a;)S[j]=E[j];return S[a]=d(z),X(r,this,S)}}(t,n,re),t+"")}function jt(t,n){var r,a,d=t.__data__;return((a=typeof(r=n))=="string"||a=="number"||a=="symbol"||a=="boolean"?r!=="__proto__":r===null)?d[typeof n=="string"?"string":"hash"]:d.map}function Ft(t,n){var r=function(a,d){return a==null?void 0:a[d]}(t,n);return Oe(r)?r:void 0}function Qt(t,n){var r=typeof t;return!!(n=n==null?v:n)&&(r=="number"||r!="symbol"&&b.test(t))&&t>-1&&t%1==0&&t<n}function Yt(t){var n=t&&t.constructor;return t===(typeof n=="function"&&n.prototype||ot)}function Tt(t,n){if((n!=="constructor"||typeof t[n]!="function")&&n!="__proto__")return t[n]}var we=function(t){var n=0,r=0;return function(){var a=ye(),d=c-(a-r);if(r=a,d>0){if(++n>=I)return arguments[0]}else n=0;return t.apply(void 0,arguments)}}(mt?function(t,n){return mt(t,"toString",{configurable:!0,enumerable:!1,value:(r=n,function(){return r}),writable:!0});var r}:re);function St(t,n){return t===n||t!=t&&n!=n}var kt=Wt(function(){return arguments}())?Wt:function(t){return gt(t)&&Y.call(t,"callee")&&!he.call(t,"callee")},Nt=Array.isArray;function xt(t){return t!=null&&te(t.length)&&!Lt(t)}var Zt=pe||function(){return!1};function Lt(t){if(!it(t))return!1;var n=Ot(t);return n==m||n==x||n==y||n==i}function te(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=v}function it(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}function gt(t){return t!=null&&typeof t=="object"}var ee=W?function(t){return function(n){return t(n)}}(W):function(t){return gt(t)&&te(t.length)&&!!h[Ot(t)]};function ne(t){return xt(t)?be(t,!0):je(t)}var Ct,Ee=(Ct=function(t,n,r){Xt(t,n,r)},Se(function(t,n){var r=-1,a=n.length,d=a>1?n[a-1]:void 0,E=a>2?n[2]:void 0;for(d=Ct.length>3&&typeof d=="function"?(a--,d):void 0,E&&function(J,z,S){if(!it(S))return!1;var V=typeof z;return!!(V=="number"?xt(S)&&Qt(z,S.length):V=="string"&&z in S)&&St(S[z],J)}(n[0],n[1],E)&&(d=a<3?void 0:d,a=1),t=Object(t);++r<a;){var j=n[r];j&&Ct(t,j,r,d)}return t}));function re(t){return t}s.exports=Ee}).call(this,f(4)(D))},function(D,O){D.exports=function(f){return f.webpackPolyfill||(f.deprecate=function(){},f.paths=[],f.children||(f.children=[]),Object.defineProperty(f,"loaded",{enumerable:!0,get:function(){return f.l}}),Object.defineProperty(f,"id",{enumerable:!0,get:function(){return f.i}}),f.webpackPolyfill=1),f}},function(D,O,f){function s(g){return(s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i})(g)}function u(g,i){var e=Object.keys(g);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(g);i&&(o=o.filter(function(b){return Object.getOwnPropertyDescriptor(g,b).enumerable})),e.push.apply(e,o)}return e}function p(g){for(var i,e=1;e<arguments.length;e++)i=arguments[e]==null?{}:arguments[e],e%2?u(i,!0).forEach(function(o){c(g,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(i)):u(i).forEach(function(o){Object.defineProperty(g,o,Object.getOwnPropertyDescriptor(i,o))});return g}function I(g,i){for(var e,o=0;o<i.length;o++)(e=i[o]).enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(g,e.key,e)}function c(g,i,e){return i in g?Object.defineProperty(g,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):g[i]=e,g}var v,l,y="https://api.flagsmith.com/api/v1/",m=f(6),x=function(g){return"Attempted to "+g+" a user before calling flagsmith.init. Call flagsmith.init first, if you wish to prevent it sending a request for flags, call init with preventFetch:true."},A=function(){function g(i){var e=this;(function(o,b){if(!(o instanceof b))throw new TypeError("Cannot call a class as a function")})(this,g),c(this,"getJSON",function(o,b,h){var F=e.environmentID,k=e.headers,P={method:b||"GET",body:h,headers:{"x-environment-key":F}};return b&&b!=="GET"&&(P.headers["Content-Type"]="application/json; charset=utf-8"),k&&Object.assign(P.headers,k),v(o,P).then(function(L){return L.text().then(function(C){var _=C;try{_=JSON.parse(C)}catch{}return L.ok?_:Promise.reject(_)})})}),c(this,"getFlags",function(o,b){var h=e.onChange,F=e.onError,k=e.identity,P=e.api,L=(e.disableCache,!1),C=function(_,$){var tt=_.flags,W=_.traits;e.withTraits=!1;var X={},N={};if(W=W||[],(tt=tt||[]).forEach(function(w){X[w.feature.name.toLowerCase().replace(/ /g,"_")]={id:w.feature.id,enabled:w.enabled,value:w.feature_state_value}}),W.forEach(function(w){N[w.trait_key.toLowerCase().replace(/ /g,"_")]=w.trait_value}),e.oldFlags=p({},e.flags),$){var H={};$.map(function(w){H[w.name]=w}),e.segments=H}var Q=m(e.flags,X),q=m(e.traits,N);e.flags=X,e.traits=N,e.updateStorage(),h&&h(e.oldFlags,{isFromServer:!0,flagsChanged:!Q,traitsChanged:!q})};return k?Promise.all([e.withTraits?e.getJSON(P+"identities/","POST",JSON.stringify({identifier:k,traits:Object.keys(e.withTraits).map(function(_){return{trait_key:_,trait_value:e.withTraits[_]}})})):e.getJSON(P+"identities/?identifier="+encodeURIComponent(k))]).then(function(_){C(_[0],_[1]),o&&!L&&(L=!0,o())}).catch(function(_){var $=_.message;F&&F({message:$})}):Promise.all([e.getJSON(P+"flags/")]).then(function(_){C({flags:_[0]},null),o&&!L&&(L=!0,o())}).catch(function(_){b&&!L&&(L=!0,b(_)),F&&F(_)})}),c(this,"analyticsFlags",function(){var o=e.api;if(Object.getOwnPropertyNames(e.evaluationEvent).length!==0)return e.getJSON(o+"analytics/flags/","POST",JSON.stringify(e.evaluationEvent)).then(function(){state=e.getState(),e.setState(p({},state,{evaluationEvent:{}})),e.updateEventStorage()}).catch(function(b){e.log("Exception fetching evaluationEvent",b)})}),c(this,"evaluateFlag",function(o){if(e.enableAnalytics){if(!e.evaluationEvent)return;e.evaluationEvent[o]===void 0&&(e.evaluationEvent[o]=0),e.evaluationEvent[o]+=1}e.updateEventStorage()}),c(this,"getValue",function(o){var b=e.flags&&e.flags[o.toLowerCase().replace(/ /g,"_")],h=null;return b&&(h=b.value),e.evaluateFlag(o),h}),c(this,"getTrait",function(o){return e.traits&&e.traits[o.toLowerCase().replace(/ /g,"_")]}),c(this,"setTrait",function(o,b){var h=e.getJSON,F=e.identity,k=e.api;if(k)return h("".concat(k,"traits/"),"POST",JSON.stringify({identity:{identifier:F},trait_key:o,trait_value:b})).then(function(){e.initialised&&e.getFlags()});console.error(x("setTrait"))}),c(this,"setTraits",function(o){var b=e.getJSON,h=e.identity,F=e.api;if(F){o&&s(o)==="object"||console.error("Expected object for flagsmith.setTraits");var k=Object.keys(o).map(function(P){return{identity:{identifier:h},trait_key:P,trait_value:o[P]}});return b("".concat(F,"traits/bulk/"),"PUT",JSON.stringify(k)).then(function(){e.initialised&&e.getFlags()})}console.error(x("setTraits"))}),c(this,"incrementTrait",function(o,b){var h=e.getJSON,F=e.identity,k=e.api;return h("".concat(k,"traits/increment-value/"),"POST",JSON.stringify({trait_key:o,increment_by:b,identifier:F})).then(e.getFlags)}),c(this,"hasFeature",function(o){var b=e.flags&&e.flags[o.toLowerCase().replace(/ /g,"_")],h=!1;return b&&b.enabled&&(h=!0),e.evaluateFlag(o),h}),v=i.fetch?i.fetch:lt.fetch,l=i.AsyncStorage}return function(i,e,o){e&&I(i.prototype,e),o&&I(i,o)}(g,[{key:"init",value:function(i){var e=this,o=i.environmentID,b=i.api,h=b===void 0?y:b,F=i.headers,k=i.onChange,P=i.cacheFlags,L=i.onError,C=i.defaultFlags,_=i.preventFetch,$=i.enableLogs,tt=i.enableAnalytics,W=i.AsyncStorage,X=i.state;return new Promise(function(N,H){if(e.environmentID=o,e.api=h,e.headers=F,e.getFlagInterval=null,e.analyticsInterval=null,e.onChange=k,e.onError=L,e.enableLogs=$,e.enableAnalytics=!!tt&&tt,e.flags=Object.assign({},C)||{},e.initialised=!0,e.ticks=1e4,e.timer=e.enableLogs?new Date().valueOf():null,W&&(l=W),e.cacheFlags=l!==void 0&&P,e.setState(X),!o)throw H("Please specify a environment id"),"Please specify a environment id";l.getItem("BULLET_TRAIN_EVENT").then(function(Q){if(Q)try{e.evaluationEvent=JSON.parse(Q)}catch{e.evaluationEvent={}}else e.evaluationEvent={};e.analyticsInterval=setInterval(e.analyticsFlags,e.ticks)}),e.enableAnalytics&&(e.analyticsInterval&&clearInterval(e.analyticsInterval),l.getItem("BULLET_TRAIN_EVENT",function(Q,q){if(q){var w=JSON.parse(q);w&&(X=e.getState(),e.log("Retrieved events from cache",q),e.setState(p({},X,{evaluationEvent:w})))}})),P?l.getItem("BULLET_TRAIN_DB",function(Q,q){if(q)try{var w=JSON.parse(q);w&&w.api===e.api&&w.environmentID===e.environmentID&&(e.setState(w),e.log("Retrieved flags from cache",w)),e.flags?(e.onChange&&e.onChange(null,{isFromServer:!1}),e.oldFlags=e.flags,N(),!_&&e.getFlags(Promise.resolve,Promise.reject)):_?N():e.getFlags(N,H)}catch(ot){e.log("Exception fetching cached logs",ot)}else _?(C&&e.onChange(null,{isFromServer:!1}),N()):e.getFlags(N,H)}):_?(C&&e.onChange(null,{isFromServer:!1}),N()):e.getFlags(N,H)}).catch(function(N){return L(N)})}},{key:"getAllFlags",value:function(){return this.flags}},{key:"identify",value:function(i,e){return this.identity=i,e&&(this.withTraits=e),this.initialised&&!this.getFlagInterval?this.getFlags():Promise.resolve()}},{key:"getState",value:function(){return{api:this.api,environmentID:this.environmentID,flags:this.flags,identity:this.identity,segments:this.segments,traits:this.traits,evaluationEvent:this.evaluationEvent}}},{key:"setState",value:function(i){i&&(this.initialised=!0,this.api=i.api||this.api||y,this.environmentID=i.environmentID||this.environmentID,this.flags=i.flags||this.flags,this.identity=i.identity||this.identity,this.segments=i.segments||this.segments,this.traits=i.traits||this.traits,this.evaluationEvent=i.evaluationEvent||this.evaluationEvent)}},{key:"log",value:function(){if(this.enableLogs){for(var i=arguments.length,e=Array(i),o=0;o<i;o++)e[o]=arguments[o];console.log.apply(this,["FLAGSMITH:",new Date().valueOf()-this.timer,"ms"].concat(e))}}},{key:"updateStorage",value:function(){if(this.cacheFlags){var i=JSON.stringify(this.getState());this.log("Setting storage",i),l.setItem("BULLET_TRAIN_DB",i)}}},{key:"updateEventStorage",value:function(){if(this.enableAnalytics){var i=JSON.stringify(this.getState().evaluationEvent);this.log("Setting event storage",i),l.setItem("BULLET_TRAIN_EVENT",i)}}},{key:"logout",value:function(){return this.identity=null,this.segments=null,this.traits=null,this.initialised&&!this.getFlagInterval?this.getFlags():Promise.resolve()}},{key:"startListening",value:function(){var i=0<arguments.length&&arguments[0]!==void 0?arguments[0]:1e3;this.getFlagInterval&&clearInterval(this.getFlagInterval),this.getFlagInterval=setInterval(this.getFlags,i)}},{key:"stopListening",value:function(){clearInterval(this.getFlagInterval),this.getFlagInterval=null}},{key:"getSegments",value:function(){}}]),g}();D.exports=function(g){var i=g.fetch,e=g.AsyncStorage;return new A({fetch:i,AsyncStorage:e})}},function(D,O,f){D.exports=function s(u,p){if(u===p)return!0;if(u&&p&&typeof u=="object"&&typeof p=="object"){if(u.constructor!==p.constructor)return!1;var I,c,v;if(Array.isArray(u)){if((I=u.length)!=p.length)return!1;for(c=I;c--!=0;)if(!s(u[c],p[c]))return!1;return!0}if(u.constructor===RegExp)return u.source===p.source&&u.flags===p.flags;if(u.valueOf!==Object.prototype.valueOf)return u.valueOf()===p.valueOf();if(u.toString!==Object.prototype.toString)return u.toString()===p.toString();if((I=(v=Object.keys(u)).length)!==Object.keys(p).length)return!1;for(c=I;c--!=0;)if(!Object.prototype.hasOwnProperty.call(p,v[c]))return!1;for(c=I;c--!=0;){var l=v[c];if(!s(u[l],p[l]))return!1}return!0}return u!=u&&p!=p}}])})})(le);var Te=Ae(le.exports);export{Te as f};
